<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/core-ajax/core-ajax.html">

<polymer-element name="contacts-list" attributes="selContact allContacts">
  <template>
    <link rel="stylesheet" href="contacts-list.css">
    <link rel="stylesheet" href="../../styles/palette.css">
    <style>
      .contact_list{
        font-size: .6em;
        padding:5px 3px
      }
      .contact{
        padding:6px;
      }

    </style>

    <ul>
      <template repeat="{{contact in allContacts | filterContacts(filterOn)}}">
        <li class="contact secondary-text-color" on-tap="{{selectContact}}">{{contact.name.last}}, {{contact.name.first}} </li>
      </template>
    </ul>
  </template>
  <script>
    (function () {
      Polymer({
        // define element prototype here
        filterContacts: function(contacts, filterOn){
          return contacts.filter(function(contact){
            var pat = new RegExp(filterOn,"i"),
              inLast = pat.test(contact.name.last),
              inFirst = pat.test(contact.name.first);
              if(inFirst || inLast){
                return true;
              }else{
                console.log('failed the filter');
                return false;
              }
          });
        },
        publish:{
          allContacts:[],
          filterOn:'',
          selContact:{}
        },
        selectContact: function(e, detail, elem){
          this.selContact = elem.templateInstance_.model.contact;
        }
      });
    })();
  </script>
</polymer-element>
