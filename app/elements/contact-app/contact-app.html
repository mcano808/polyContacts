<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../scheduled-call/scheduled-call.html">
<link rel="import" href="../contacts-list/contacts-list.html">
<link rel="import" href="../contact-card/contact-card.html">
<link rel="import" href="../new-contact/new-contact.html">
<link rel="import" href="../auto-scroller/auto-scroller.html">
<link rel="import" href="../../bower_components/core-scaffold/core-scaffold.html">
<link rel="import" href="../../bower_components/core-toolbar/core-toolbar.html">
<link rel="import" href="../../bower_components/core-animated-pages/core-animated-pages.html">
<link rel="import" href="../../bower_components/core-animated-pages/transitions/slide-from-right.html">
<link rel="import" href="../../bower_components/paper-fab/paper-fab.html">
<link rel="import" href="../../bower_components/core-icons/core-icons.html">
<link rel="import" href="../../bower_components/core-icon/core-icon.html">
<link rel="import" href="../../bower_components/core-header-panel/core-header-panel.html">
<link rel="import" href="../../bower_components/yoso-searchfield/yoso-searchfield.html">

<polymer-element name="contact-app">
  <template>
    <style>
      :host {
        display: block;
      }

      .newContact{
        position: absolute!important;
        bottom:-10px;
        right:-20px;
        z-index:10;

      }
      :host /deep/ core-toolbar{
        background-color:#388E3C;
        font-size: .95em;
      }

      .contact_list_title{
        font-size: .80em;
      }
      .logo{
        height:40px;
        width:40px;
        color:#cddc39;
      }
      .page-title{
        font-size: 1.5em;
      }

    </style>
    <core-scaffold>
      <!-- Left Side (Collapsing) -->
      <nav>
        <core-toolbar layout horizonal>
          <yoso-searchfield hint="Find me..." text="{{searchValue}}" flex></yoso-searchfield>
        </core-toolbar>
        <div layout horizontal>
        <contacts-list flex id="contactList"></contacts-list>
        <auto-scroller></auto-scroller>
        </div>
      </nav>

      <!-- Right side and main content -->
      <core-toolbar tool flex>
        <div layout horizontal flex>
          <span class="page-title" flex>{{pageTitle}}</span>
        </div>
        <template if="{{selectedPage === 0}}">
          <paper-fab icon="account-circle" class="newContact accent-color" on-tap="{{newContact}}"></paper-fab>
        </template>
        <template if="{{selectedPage === 1}}">
          <paper-fab icon="arrow-back" class="newContact accent-color" on-tap="{{backToStart}}"></paper-fab>
        </template>
      </core-toolbar>

      <!-- Main page Content here -->
      <core-animated-pages selected="{{selectedPage}}" transitions="slide-from-right" layout vertical fit>
        <scheduled-call id="scheduledCalls" selContact="{{selectedContact}}"></scheduled-call>
        <contact-card contact="{{selectedContact}}"></contact-card>
      </core-animated-pages>
    </core-scaffold>
  </template>
  <script>
    (function () {
      Polymer({
        backToStart:function (e){
          this.selectedPage = 0;
          //DO NOT CHANGE selectedContact as this will make the page cycle again.
          this.pageTitle = 'Today...'
        },
        // define element prototype here
        contacts:null,
        gotData: function(evt, detail){
          console.log('got test data:', arguments);
          this.contacts = detail.response.contacts;
        },
        newContact:function(e, detail, target){
          console.log('making new contact: ', arguments)
        },
        selectedContact:{},
        selectedPage:0,
        pageTitle: 'Today...',
        selectedPageChanged: function(ov, nv){
          console.log('selectedPage changed', arguments);
        },
        selectedContactChanged: function(ov, nv){
          console.log('selected contact changed', arguments);
          //Change selected page to contact card
          this.selectedPage = 1;
          //Set the contact name as the page title
          this.pageTitle = this.selectedContact.name.last + ', ' + this.selectedContact.name.first;
          //Add a back button someplace to go back to today's contacts.
        }

      });
    })();
  </script>
</polymer-element>
